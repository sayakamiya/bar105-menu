<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<!-- ãƒ¢ãƒã‚¤ãƒ«ã§ã®èª¤ã‚ºãƒ¼ãƒ é˜²æ­¢ï¼ˆãƒœã‚¿ãƒ³é€£æ‰“ã§æ‹¡å¤§ã—ãªã„ï¼‰ -->
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>ğŸ¸ Bar105 ã‚ªãƒ¼ãƒ€ãƒ¼è¨ˆç®—ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¹ãƒãƒ›/PCå¯¾å¿œï¼‰</title>

<style>
  :root{
    --gold:#c9a227;
    --muted:#d9cfc6;
    --bg-wood-1:#1b1410;
    --bg-wood-2:#3a2b24;
    --card-wood:#2a201b;
    --accent-dark:#201814;
    --gap:12px;
    --btn-size-desktop:40px;
    --btn-size-mobile:54px;
    --radius:10px;
    --danger:#b94a4a;
  }

  *{box-sizing:border-box;}
  html,body{height:100%;}
  body{
    margin:0;
    padding:20px;
    font-family:"Noto Sans JP",system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background:linear-gradient(180deg,var(--bg-wood-1),var(--bg-wood-2));
    color:var(--muted);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    -webkit-user-select:none;
  }

  /* header */
  header{display:flex; align-items:center; justify-content:space-between; gap:12px; margin-bottom:16px;}
  h1{margin:0; color:var(--gold); font-size:18px;}
  .top-controls{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}
  .btn {background:#3a2b24; color:var(--muted); border:1px solid #4d3d2d; border-radius:8px; padding:8px 10px; cursor:pointer; font-size:14px;}
  .btn:hover{background:#4a3a2e; color:var(--gold);}
  .small {padding:6px 8px; font-size:13px;}

  /* layout */
  .container{max-width:1200px; margin:0 auto;}
  .menu-area {display:grid; grid-template-columns:1fr 1fr; gap:18px;}
  @media(max-width:900px){ .menu-area{grid-template-columns:1fr;} }

  .menu-group {background:var(--card-wood); padding:12px; border-radius:var(--radius); box-shadow:0 6px 18px rgba(0,0,0,0.35);}
  .menu-group-header {display:flex; justify-content:space-between; align-items:center; gap:8px; margin-bottom:10px;}
  .menu-group h2{margin:0; font-size:16px; color:var(--gold); display:flex; align-items:center; gap:8px;}
  .group-actions{display:flex; gap:8px; align-items:center;}

  .menu-item {
    background:var(--accent-dark);
    border:1px solid #3c2f27;
    border-radius:8px;
    padding:10px;
    margin-bottom:12px;
    display:flex;
    flex-direction:column;
    gap:8px;
  }
  .title-row{display:flex; justify-content:space-between; align-items:center; gap:8px;}
  .name{font-weight:700; font-size:15px;}
  .price{min-width:90px; text-align:right; white-space:nowrap;}

  .btn-row {display:flex; gap:8px; align-items:center; flex-wrap:wrap;}
  /* desktop qty button */
  .qty-btn {
    width:var(--btn-size-desktop);
    height:var(--btn-size-desktop);
    display:inline-grid; place-items:center;
    border-radius:8px;
    background:#3a2b24; color:var(--muted);
    border:1px solid #4d3d2d; cursor:pointer; font-weight:700;
    touch-action: manipulation; -webkit-tap-highlight-color: rgba(0,0,0,0);
  }
  .qty-btn:hover{background:#4a3a2e; color:var(--gold);}
  .qty {display:inline-block; min-width:52px; text-align:center; font-weight:800; font-size:16px;}

  .summary {
    margin-top:18px;
    background:var(--card-wood);
    border-radius:var(--radius);
    padding:14px;
    box-shadow:0 6px 18px rgba(0,0,0,0.25);
  }
  .order-line{display:flex; justify-content:space-between; margin-bottom:8px; font-size:15px;}
  .total{font-size:20px; text-align:right; color:#fff; margin-top:8px;}

  .control{margin-top:10px; display:flex; gap:8px; flex-wrap:wrap;}
  .control .btn{flex:1}

  .editable {background:rgba(255,255,255,0.02); padding:6px; border-radius:6px;}
  .input-inline {background:transparent; border:1px dashed rgba(255,255,255,0.06); color:var(--muted); padding:4px 6px; border-radius:4px; min-width:60px;}

  .delete-btn {background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:6px 8px; border-radius:6px; cursor:pointer;}
  .delete-btn:hover{background:rgba(185,74,74,0.08); color:var(--danger); border-color:var(--danger);}

  /* small helper */
  .muted {color:#bfb3a8; font-size:13px;}
  .inline {display:inline-flex; gap:8px; align-items:center;}

  /* modern theme */
  body.modern {
    background:linear-gradient(180deg,#0f1112,#151619);
    color:#eee;
  }
  body.modern .menu-group {background:#141416;}
  body.modern .menu-item {background:#0e0f10; border-color:#252627;}
  body.modern .btn {background:#1a1b1c; border-color:#333;}
  body.modern .btn:hover{color:#fff;}
  body.modern h1{color:#ffffff;}
  body.modern .menu-group h2{color:#ffffff;}
  body.modern .qty-btn{background:#1b1c1d; border-color:#333;}

  /* ============= ãƒ¢ãƒã‚¤ãƒ«å°‚ç”¨ ============= */
  @media (max-width:600px) {
    body{padding:12px;}
    header{flex-direction:column; align-items:flex-start; gap:8px;}
    h1{font-size:17px;}
    .top-controls{width:100%; display:flex; gap:8px; flex-wrap:wrap;}
    .menu-area{grid-template-columns:1fr;}
    .menu-group{padding:10px;}
    .menu-item{padding:12px;}
    .title-row{flex-direction:row;}
    .price{min-width:72px; font-size:14px;}

    /* ãƒ¢ãƒã‚¤ãƒ«æ™‚ã¯ãƒœã‚¿ãƒ³ã‚’å…¨å¹…ã§è¦‹ã‚„ã™ã2æ®µæ§‹æˆã« */
    .btn-row {display:block; width:100%;}
    .btn-group-row {display:flex; gap:8px; width:100%;}
    .qty-btn {
      width:100%;
      height:var(--btn-size-mobile);
      border-radius:8px;
      font-size:16px;
      display:inline-flex;
      justify-content:center;
      align-items:center;
      -webkit-user-select:none; user-select:none;
      touch-action: manipulation;
    }
    .qty {display:block; text-align:center; font-size:18px; margin:6px 0; font-weight:800;}

    .menu-item .controls-row {display:flex; gap:8px; justify-content:space-between; align-items:center;}
    .delete-btn{padding:8px 10px;}
    .group-actions{gap:6px;}
  }

  /* large screens tweaks */
  @media (min-width:1200px){
    body{padding:28px;}
    .menu-item{padding:14px;}
  }

  /* accessibility focus */
  .qty-btn:focus, .btn:focus, .delete-btn:focus {outline:2px solid rgba(201,162,39,0.25); outline-offset:2px;}

  /* sort icon small */
  .sort-btn {background:transparent; border:1px dashed rgba(255,255,255,0.04); color:var(--muted); padding:6px 8px; border-radius:6px; cursor:pointer;}
  .sort-btn:hover{color:var(--gold); border-color:var(--gold);}
</style>
</head>
<body>

<div class="container">

  <header>
    <h1>ğŸ¸ Bar105 ã‚ªãƒ¼ãƒ€ãƒ¼è¨ˆç®—ãƒ„ãƒ¼ãƒ«ï¼ˆã‚¹ãƒãƒ›/PCå¯¾å¿œï¼‰</h1>

    <div class="top-controls">
      <button class="btn small" id="toggle-edit">ç·¨é›† OFF</button>
      <button class="btn small" id="theme-switch">ğŸ¨ ãƒ†ãƒ¼ãƒ</button>
      <button class="btn small" id="switch-device">ğŸ“±â‡†ğŸ’» åˆ‡æ›¿</button>
      <button class="btn small" id="add-item-btn">ï¼‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ </button>
      <button class="btn small" id="reset-default">åˆæœŸåŒ–</button>
    </div>
  </header>

  <!-- ================== ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ ================== -->
  <div class="menu-area">

    <!-- é£Ÿã¹ç‰©ã‚°ãƒ«ãƒ¼ãƒ— -->
    <div class="menu-group" data-group="food">
      <div class="menu-group-header">
        <h2>ğŸ½ é£Ÿã¹ç‰©</h2>
        <div class="group-actions">
          <button class="sort-btn" onclick="sortGroup('food')">Â¥å®‰ã„é †</button>
        </div>
      </div>
      <div id="group-food"></div>
    </div>

    <!-- é£²ã¿ç‰©ã‚°ãƒ«ãƒ¼ãƒ— -->
    <div class="menu-group" data-group="drink">
      <div class="menu-group-header">
        <h2>ğŸ¹ é£²ã¿ç‰©</h2>
        <div class="group-actions">
          <button class="sort-btn" onclick="sortGroup('drink')">Â¥å®‰ã„é †</button>
        </div>
      </div>
      <div id="group-drink"></div>
    </div>

  </div>

  <!-- ================== æ³¨æ–‡å†…å®¹ã‚¨ãƒªã‚¢ ================== -->
  <div class="summary">
    <h2>ğŸ§¾ æ³¨æ–‡å†…å®¹</h2>

    <div id="order-list"></div>

    <div class="total" id="total-price">Â¥0</div>

    <div class="control">
      <button class="btn" id="copy-order">å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼</button>
      <button class="btn" id="copy-total">åˆè¨ˆã‚’ã‚³ãƒ”ãƒ¼</button>
      <button class="btn" id="reset-order">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <div class="muted" style="margin-top:10px;">
      â€» ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç·¨é›†ãƒ»è¿½åŠ ãƒ»å‰Šé™¤ã®å†…å®¹ã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¾ã™ï¼ˆlocalStorageï¼‰<br>
      â€» PC / ã‚¹ãƒãƒ›ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡æ›¿ã¯ã‚ãªãŸã®ç’°å¢ƒã ã‘ã«ä¿å­˜ã•ã‚Œã¾ã™
    </div>
  </div>

</div><!-- container çµ‚ã‚ã‚Š -->

<!-- ================== ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ ãƒ€ã‚¤ã‚¢ãƒ­ã‚° ================== -->
<div id="add-dialog" style="
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,0.55); backdrop-filter:blur(3px);
  align-items:center; justify-content:center; z-index:999;
">
  <div style="
    background:rgba(30,25,20,0.95);
    padding:18px; border-radius:12px;
    width:320px; color:var(--muted);
    box-shadow:0 8px 22px rgba(0,0,0,0.45);
  ">
    <h3 style="margin-top:0; color:var(--gold);">ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ </h3>

    <div style="display:flex; flex-direction:column; gap:10px;">

      <label>ã‚°ãƒ«ãƒ¼ãƒ—
        <select id="new-group">
          <option value="food">ğŸ½ é£Ÿã¹ç‰©</option>
          <option value="drink">ğŸ¹ é£²ã¿ç‰©</option>
        </select>
      </label>

      <label>åå‰
        <input id="new-name" type="text" placeholder="ä¾‹: ç”Ÿãƒãƒ ã®ç››ã‚Šåˆã‚ã›">
      </label>

      <label>ä¾¡æ ¼ï¼ˆå††ï¼‰
        <input id="new-price" type="number" min="0" value="1000">
      </label>

      <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:8px;">
        <button class="btn" id="add-confirm">è¿½åŠ </button>
        <button class="btn" id="add-cancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      </div>

    </div>
  </div>
</div>
<!-- ================== å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° ================== -->
<div id="delete-dialog" style="
  display:none; position:fixed; inset:0;
  background:rgba(0,0,0,0.55); backdrop-filter:blur(3px);
  align-items:center; justify-content:center; z-index:999;
">
  <div style="
    background:rgba(35,20,20,0.95);
    padding:18px; border-radius:12px;
    width:300px; color:var(--muted);
    box-shadow:0 8px 22px rgba(0,0,0,0.45);
  ">
    <h3 style="margin-top:0; color:var(--danger);">å‰Šé™¤ç¢ºèª</h3>
    <div id="delete-target-name" style="margin-bottom:12px; font-size:15px;"></div>

    <div style="display:flex; gap:10px; justify-content:flex-end;">
      <button class="btn" id="delete-confirm" style="background:#712e2e; border-color:#8a3b3b; color:#fff;">
        å‰Šé™¤ã™ã‚‹
      </button>
      <button class="btn" id="delete-cancel">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
    </div>
  </div>
</div>

<!-- ================== å¼·åˆ¶ PC / ã‚¹ãƒãƒ› UI åˆ‡æ›¿è¡¨ç¤ºã‚¨ãƒªã‚¢ ================== -->
<div id="device-mode-bar" style="
  position:fixed; bottom:10px; right:10px;
  background:rgba(0,0,0,0.45);
  padding:6px 10px; border-radius:8px;
  font-size:12px; color:var(--muted);
  z-index:9999; pointer-events:none;
">
  ç¾åœ¨ãƒ¢ãƒ¼ãƒ‰: <span id="device-mode-text">auto</span>
</div>
<script>
/* ============================================================
   è¨­å®š
============================================================ */
const STORAGE_KEY = "bar105_menu_data_v3";
const THEME_KEY   = "bar105_theme_v3";
const DEVICE_KEY  = "bar105_device_mode_v3"; // auto / mobile / pc

/* ============================================================
   æœ€æ–°ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆã‚ãªãŸã®ä¾é ¼ã©ãŠã‚Šåæ˜ ï¼‰
============================================================ */
const DEFAULT_MENUS = [
  /* ==== é£Ÿã¹ç‰© ==== */
  {id:"food_ajillo", name:"ã‚¢ãƒ’ãƒ¼ã‚¸ãƒ§ï¼ˆè…¹50%ï¼‰", price:10000, group:"food"},
  {id:"food_apple", name:"ã‚Šã‚“ã”ã¨ã‚·ãƒŠãƒ¢ãƒ³ã®ã‚¹ãƒ†ã‚£ãƒƒã‚¯ï¼ˆè…¹40%ï¼‰", price:6000, group:"food"},
  {id:"food_ham",   name:"ç”Ÿãƒãƒ ï¼ˆè…¹35%ï¼‰", price:4500, group:"food"},
  {id:"food_caprese", name:"ã‚«ãƒ—ãƒ¬ãƒ¼ã‚¼ï¼ˆè…¹35%ï¼‰", price:4500, group:"food"},
  {id:"food_nuts",  name:"ãƒŸãƒƒã‚¯ã‚¹ãƒŠãƒƒãƒ„ï¼ˆè…¹20%ï¼‰", price:3000, group:"food"},

  /* ==== é£²ã¿ç‰© ==== */
  {id:"drink_tequila", name:"ãƒ†ã‚­ãƒ¼ãƒ©ã‚µãƒ³ãƒ©ã‚¤ã‚ºï¼ˆæ°´åˆ†50%ï¼‰", price:15000, group:"drink"},
  {id:"drink_martini", name:"ãƒãƒ†ã‚£ãƒ¼ãƒ‹ï¼ˆæ°´åˆ†50%ï¼‰", price:15000, group:"drink"},
  {id:"drink_manhattan", name:"ãƒãƒ³ãƒãƒƒã‚¿ãƒ³ï¼ˆæ°´åˆ†50%ï¼‰", price:15000, group:"drink"},
  {id:"drink_whisky", name:"ã‚¦ã‚£ã‚¹ã‚­ãƒ¼ãƒ­ãƒƒã‚¯ï¼ˆæ°´åˆ†40%ï¼‰", price:7000, group:"drink"},
  {id:"drink_mojito", name:"ãƒ¢ãƒ’ãƒ¼ãƒˆï¼ˆæ°´åˆ†40%ï¼‰", price:7000, group:"drink"},   /* â†è¿½åŠ åˆ† */
  {id:"drink_gintonic", name:"ã‚¸ãƒ³ãƒˆãƒ‹ãƒƒã‚¯ï¼ˆæ°´åˆ†35%ï¼‰", price:5500, group:"drink"},
  {id:"drink_kahlua", name:"ã‚«ãƒ«ãƒ¼ã‚¢ãƒŸãƒ«ã‚¯ï¼ˆæ°´åˆ†35%ï¼‰", price:5500, group:"drink"},
  {id:"drink_fuzzy", name:"ãƒ•ã‚¡ã‚¸ãƒ¼ãƒãƒ¼ãƒ–ãƒ«ï¼ˆæ°´åˆ†35%ï¼‰", price:5500, group:"drink"},
  {id:"drink_craftbeer", name:"ã‚¯ãƒ©ãƒ•ãƒˆãƒ“ãƒ¼ãƒ«ï¼ˆæ°´åˆ†20%ï¼‰", price:4000, group:"drink"}
];

let menus = loadMenus();
let order = {};
let editMode = false;
let deleteTargetId = null;

/* ============================================================
   localStorage load / save
============================================================ */
function loadMenus(){
  try{
    const raw = localStorage.getItem(STORAGE_KEY);
    if(raw) return JSON.parse(raw);
  }catch(e){}
  localStorage.setItem(STORAGE_KEY, JSON.stringify(DEFAULT_MENUS));
  return JSON.parse(JSON.stringify(DEFAULT_MENUS));
}

function saveMenus(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(menus));
}

/* ============================================================
   ãƒ†ãƒ¼ãƒé©ç”¨
============================================================ */
function applyTheme(){
  const t = localStorage.getItem(THEME_KEY) || "classic";
  document.body.classList.toggle("modern", t === "modern");

  const btn = document.getElementById("theme-switch");
  btn.textContent = (t === "modern") ? "ğŸ¨ Modern" : "ğŸ¨ Bar";
}

function toggleTheme(){
  const cur = localStorage.getItem(THEME_KEY) || "classic";
  const next = (cur === "classic") ? "modern" : "classic";
  localStorage.setItem(THEME_KEY, next);
  applyTheme();
}

/* ============================================================
   ãƒ‡ãƒã‚¤ã‚¹ãƒ¢ãƒ¼ãƒ‰ç®¡ç†ï¼ˆauto / mobile / pcï¼‰
============================================================ */
function getDeviceMode(){
  return localStorage.getItem(DEVICE_KEY) || "auto";
}

function applyDeviceMode(){
  const mode = getDeviceMode();
  const bar = document.getElementById("device-mode-bar");
  const label = document.getElementById("device-mode-text");

  label.textContent = mode;

  document.body.classList.remove("force-pc","force-mobile");

  if(mode === "pc"){
    document.body.classList.add("force-pc");
  } else if(mode === "mobile"){
    document.body.classList.add("force-mobile");
  }
}

function toggleDeviceMode(){
  const cur = getDeviceMode();
  let next = "auto";
  if(cur === "auto") next = "mobile";
  else if(cur === "mobile") next = "pc";
  else next = "auto";

  localStorage.setItem(DEVICE_KEY, next);
  applyDeviceMode();
}

/* ============================================================
   ãƒ¡ãƒ‹ãƒ¥ãƒ¼æç”»
============================================================ */
function renderMenus(){
  const foodEl  = document.getElementById("group-food");
  const drinkEl = document.getElementById("group-drink");

  foodEl.innerHTML = "";
  drinkEl.innerHTML = "";

  for(const it of menus){
    const card = document.createElement("div");
    card.className = "menu-item";
    card.dataset.id = it.id;
    card.dataset.group = it.group;
    card.dataset.price = it.price;
    card.dataset.name = it.name;

    /* ã‚¿ã‚¤ãƒˆãƒ«è¡Œ */
    let html = `
      <div class="title-row">
        <span class="name" ${editMode ? 'contenteditable="true"' : ''}>${it.name}</span>
        <span class="price" ${editMode ? 'contenteditable="true"' : ''}>Â¥${it.price.toLocaleString()}</span>
      </div>
    `;

    /* ã‚¹ãƒãƒ›/PCãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå…±é€š â€” ãƒœã‚¿ãƒ³ã‚»ãƒƒãƒˆ */
    html += `
      <div class="controls-row">
        
        <div class="btn-row">
          <div class="btn-group-row">
            <button class="qty-btn" onclick="updateOrder(this,1)">+1</button>
            <button class="qty-btn" onclick="updateOrder(this,5)">+5</button>
            <button class="qty-btn" onclick="updateOrder(this,10)">+10</button>
            <button class="qty-btn" onclick="updateOrder(this,50)">+50</button>
          </div>

          <span class="qty" id="qty-${it.id}">0</span>

          <div class="btn-group-row">
            <button class="qty-btn" onclick="updateOrder(this,-1)">-1</button>
            <button class="qty-btn" onclick="updateOrder(this,-5)">-5</button>
            <button class="qty-btn" onclick="updateOrder(this,-10)">-10</button>
            <button class="qty-btn" onclick="updateOrder(this,-50)">-50</button>
          </div>
        </div>

        ${editMode ? `<button class="delete-btn" onclick="requestDeleteItem('${it.id}','${it.name}')">å‰Šé™¤</button>` : ""}
      </div>
    `;

    card.innerHTML = html;

    if(it.group === "food") foodEl.appendChild(card);
    else drinkEl.appendChild(card);
  }

  /* ç·¨é›†ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ  */
  if(editMode){
    const items = document.querySelectorAll(".menu-item");
    items.forEach(card=>{
      const id = card.dataset.id;

      card.querySelector(".name").addEventListener("blur", ()=>{
        const m = menus.find(x=>x.id===id);
        if(m){
          m.name = card.querySelector(".name").textContent.trim();
          saveMenus();
        }
      });

      card.querySelector(".price").addEventListener("blur", ()=>{
        const m = menus.find(x=>x.id===id);
        if(m){
          const raw = card.querySelector(".price").textContent.replace(/[^\d]/g,"");
          m.price = parseInt(raw) || 0;
          saveMenus();
          renderMenus();
          renderOrderList();
        }
      });
    });
  }
}

/* ============================================================
   æ•°é‡æ“ä½œ
============================================================ */
function updateOrder(btn, diff){
  const card = btn.closest(".menu-item");
  const id   = card.dataset.id;
  const price = parseInt(card.dataset.price);

  if(!order[id]) order[id] = 0;
  order[id] += diff;
  if(order[id] < 0) order[id] = 0;

  document.getElementById(`qty-${id}`).textContent = order[id];
  renderOrderList();
}

/* ============================================================
   æ³¨æ–‡å†…å®¹æç”»
============================================================ */
function renderOrderList(){
  const box = document.getElementById("order-list");
  box.innerHTML = "";

  let total = 0;

  for(const it of menus){
    const q = order[it.id] || 0;
    if(q <= 0) continue;

    const line = document.createElement("div");
    line.className = "order-line";
    line.innerHTML = `
      <span>${it.name} Ã— ${q}</span>
      <span>Â¥${(it.price * q).toLocaleString()}</span>
    `;

    box.appendChild(line);
    total += it.price * q;
  }

  document.getElementById("total-price").textContent = "Â¥" + total.toLocaleString();
}

/* ============================================================
   ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ ON/OFF
============================================================ */
function toggleEditMode(){
  editMode = !editMode;
  document.getElementById("toggle-edit").textContent = editMode ? "ç·¨é›† ON" : "ç·¨é›† OFF";
  renderMenus();
}

/* ============================================================
   ãƒ¡ãƒ‹ãƒ¥ãƒ¼å‰Šé™¤å‡¦ç†
============================================================ */
function requestDeleteItem(id, name){
  deleteTargetId = id;
  document.getElementById("delete-target-name").textContent = `${name} ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`;
  document.getElementById("delete-dialog").style.display = "flex";
}

function confirmDelete(){
  if(deleteTargetId){
    menus = menus.filter(m=>m.id !== deleteTargetId);
    saveMenus();
    delete order[deleteTargetId];
    renderMenus();
    renderOrderList();
  }
  closeDeleteDialog();
}

function closeDeleteDialog(){
  deleteTargetId = null;
  document.getElementById("delete-dialog").style.display = "none";
}

/* ============================================================
   ã‚°ãƒ«ãƒ¼ãƒ—å˜ä½ ã‚½ãƒ¼ãƒˆï¼ˆå®‰ã„é †ï¼‰
============================================================ */
function sortGroup(group){
  menus = menus
    .filter(m => m.group === group)
    .sort((a,b)=>a.price - b.price)
    .concat(
      menus.filter(m => m.group !== group)
    );

  saveMenus();
  renderMenus();
}

/* ============================================================
   ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¿½åŠ 
============================================================ */
function addNewItem(){
  const name  = document.getElementById("new-name").value.trim();
  const price = parseInt(document.getElementById("new-price").value);
  const group = document.getElementById("new-group").value;

  if(!name){ alert("åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"); return; }

  const id = "item_" + Math.random().toString(36).slice(2,9);

  menus.push({id, name, price, group});
  saveMenus();

  closeAddDialog();
  renderMenus();
}

/* ============================================================
   ãƒ€ã‚¤ã‚¢ãƒ­ã‚°é–‹é–‰
============================================================ */
function openAddDialog(){
  document.getElementById("add-dialog").style.display = "flex";
}
function closeAddDialog(){
  document.getElementById("add-dialog").style.display = "none";
  document.getElementById("new-name").value = "";
  document.getElementById("new-price").value = "1000";
}

/* ============================================================
   æ³¨æ–‡ãƒªã‚»ãƒƒãƒˆ
============================================================ */
function resetOrder(){
  order = {};
  renderMenus();
  renderOrderList();
}

/* ============================================================
   ã‚³ãƒ”ãƒ¼
============================================================ */
function copyOrder(){
  let text = "";
  for(const it of menus){
    const q = order[it.id] || 0;
    if(q>0) text += `${it.name} Ã— ${q}\n`;
  }
  navigator.clipboard.writeText(text || "(ç©º)").then(()=>alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"));
}

function copyTotal(){
  const t = document.getElementById("total-price").textContent;
  navigator.clipboard.writeText(t).then(()=>alert("ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ"));
}

/* ============================================================
   å…¨åˆæœŸåŒ–ï¼ˆãƒ¡ãƒ‹ãƒ¥ãƒ¼åˆæœŸåŒ–ï¼‰
============================================================ */
function resetDefault(){
  if(!confirm("ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’åˆæœŸçŠ¶æ…‹ã«æˆ»ã—ã¾ã™ã‹ï¼Ÿ")) return;
  menus = JSON.parse(JSON.stringify(DEFAULT_MENUS));
  saveMenus();
  resetOrder();
  renderMenus();
}

/* ============================================================
   ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²
============================================================ */
document.getElementById("toggle-edit").addEventListener("click", toggleEditMode);
document.getElementById("reset-order").addEventListener("click", resetOrder);
document.getElementById("copy-order").addEventListener("click", copyOrder);
document.getElementById("copy-total").addEventListener("click", copyTotal);
document.getElementById("add-item-btn").addEventListener("click", openAddDialog);
document.getElementById("add-confirm").addEventListener("click", addNewItem);
document.getElementById("add-cancel").addEventListener("click", closeAddDialog);
document.getElementById("theme-switch").addEventListener("click", toggleTheme);
document.getElementById("reset-default").addEventListener("click", resetDefault);

document.getElementById("delete-confirm").addEventListener("click", confirmDelete);
document.getElementById("delete-cancel").addEventListener("click", closeDeleteDialog);

document.getElementById("switch-device").addEventListener("click", toggleDeviceMode);

/* ============================================================
   åˆæœŸèµ·å‹•
============================================================ */
applyTheme();
applyDeviceMode();
renderMenus();
renderOrderList();
</script>

</body>
</html>
